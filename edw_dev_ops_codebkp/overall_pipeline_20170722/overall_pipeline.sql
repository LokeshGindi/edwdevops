select 'agg_gbl_financials' as subject, 'DLY_GPR2.0_FINANCE_COPY_CEREBRO' as jobname, case status_code when 200 then 'SUCCESS' when 190 then 'FINISHED' when 80 then 'RUNNING' when 140 then ' FAILED' when 81 then ' FAILED' else ' WAITING' end as jobstatus, DATE_FORMAT(case when status_code=200 then end_time end, '%H:%i') as endtime, '17:00' as sla, SUBSTRING_INDEX(SEC_TO_TIME(TIME_TO_SEC(coalesce(time(case when status_code=200 then end_time end),CURTIME()))-TIME_TO_SEC('17:00')),':',2) as timediff, case when TIME_TO_SEC('17:00') - TIME_TO_SEC(coalesce(time(case when status_code=200 then end_time end),CURTIME())) < 0 then 'DELAYED' else case when case when status_code=200 then end_time end is not null then 'ON-TIME' else case when TIME_TO_SEC('17:00') - TIME_TO_SEC(CURTIME()) <= 3600 then 'NEAR DELAYED' else NULL end end end as delaystatus from ops_exec where (name like 'DLY_GPR2.0_FINANCE_COPY_CEREBRO_$%' or name like 'DLY_GPR2.0_FINANCE_COPY_CEREBRO_201%' or name='DLY_GPR2.0_FINANCE_COPY_CEREBRO') and cast(trigger_time as date)=current_date;
select 'agg_gbl_traffic' as subject, 'DLY_GPR2.0_TRAFFIC_COPY_CEREBRO' as jobname, case status_code when 200 then 'SUCCESS' when 190 then 'FINISHED' when 80 then 'RUNNING' when 140 then ' FAILED' when 81 then ' FAILED' else ' WAITING' end as jobstatus, DATE_FORMAT(case when status_code=200 then end_time end, '%H:%i') as endtime, '13:00' as sla, SUBSTRING_INDEX(SEC_TO_TIME(TIME_TO_SEC(coalesce(time(case when status_code=200 then end_time end),CURTIME()))-TIME_TO_SEC('13:00')),':',2) as timediff, case when TIME_TO_SEC('13:00') - TIME_TO_SEC(coalesce(time(case when status_code=200 then end_time end),CURTIME())) < 0 then 'DELAYED' else case when case when status_code=200 then end_time end is not null then 'ON-TIME' else case when TIME_TO_SEC('13:00') - TIME_TO_SEC(CURTIME()) <= 3600 then 'NEAR DELAYED' else NULL end end end as delaystatus from ops_exec where (name like 'DLY_GPR2.0_TRAFFIC_COPY_CEREBRO_$%' or name like 'DLY_GPR2.0_TRAFFIC_COPY_CEREBRO_201%' or name='DLY_GPR2.0_TRAFFIC_COPY_CEREBRO') and cast(trigger_time as date)=current_date;
select 'agg_search' as subject, 'DLY_AGG_SEARCH_BCOOKIE_DAY_NA' as jobname, case status_code when 200 then 'SUCCESS' when 190 then 'FINISHED' when 80 then 'RUNNING' when 140 then ' FAILED' when 81 then ' FAILED' else ' WAITING' end as jobstatus, DATE_FORMAT(case when status_code=200 then end_time end, '%H:%i') as endtime, '15:30' as sla, SUBSTRING_INDEX(SEC_TO_TIME(TIME_TO_SEC(coalesce(time(case when status_code=200 then end_time end),CURTIME()))-TIME_TO_SEC('15:30')),':',2) as timediff, case when TIME_TO_SEC('15:30') - TIME_TO_SEC(coalesce(time(case when status_code=200 then end_time end),CURTIME())) < 0 then 'DELAYED' else case when case when status_code=200 then end_time end is not null then 'ON-TIME' else case when TIME_TO_SEC('15:30') - TIME_TO_SEC(CURTIME()) <= 3600 then 'NEAR DELAYED' else NULL end end end as delaystatus from ops_exec where (name like 'DLY_AGG_SEARCH_BCOOKIE_DAY_NA_$%' or name like 'DLY_AGG_SEARCH_BCOOKIE_DAY_NA_201%' or name='DLY_AGG_SEARCH_BCOOKIE_DAY_NA') and cast(trigger_time as date)=current_date;
select 'attr_1_sub' as subject, 'DLY_ATTRIBUTION_3.0_INTL_SUB' as jobname, case status_code when 200 then 'SUCCESS' when 190 then 'FINISHED' when 80 then 'RUNNING' when 140 then ' FAILED' when 81 then ' FAILED' else ' WAITING' end as jobstatus, DATE_FORMAT(case when status_code=200 then end_time end, '%H:%i') as endtime, '14:30' as sla, SUBSTRING_INDEX(SEC_TO_TIME(TIME_TO_SEC(coalesce(time(case when status_code=200 then end_time end),CURTIME()))-TIME_TO_SEC('14:30')),':',2) as timediff, case when TIME_TO_SEC('14:30') - TIME_TO_SEC(coalesce(time(case when status_code=200 then end_time end),CURTIME())) < 0 then 'DELAYED' else case when case when status_code=200 then end_time end is not null then 'ON-TIME' else case when TIME_TO_SEC('14:30') - TIME_TO_SEC(CURTIME()) <= 3600 then 'NEAR DELAYED' else NULL end end end as delaystatus from ops_exec where (name like 'DLY_ATTRIBUTION_3.0_INTL_SUB_$%' or name like 'DLY_ATTRIBUTION_3.0_INTL_SUB_201%' or name='DLY_ATTRIBUTION_3.0_INTL_SUB') and cast(trigger_time as date)=current_date;
select 'attribution_3.0' as subject, 'DLY_ATTRIBUTION_JANUS_3.0' as jobname, case status_code when 200 then 'SUCCESS' when 190 then 'FINISHED' when 80 then 'RUNNING' when 140 then ' FAILED' when 81 then ' FAILED' else ' WAITING' end as jobstatus, DATE_FORMAT(case when status_code=200 then end_time end, '%H:%i') as endtime, '15:30' as sla, SUBSTRING_INDEX(SEC_TO_TIME(TIME_TO_SEC(coalesce(time(case when status_code=200 then end_time end),CURTIME()))-TIME_TO_SEC('15:30')),':',2) as timediff, case when TIME_TO_SEC('15:30') - TIME_TO_SEC(coalesce(time(case when status_code=200 then end_time end),CURTIME())) < 0 then 'DELAYED' else case when case when status_code=200 then end_time end is not null then 'ON-TIME' else case when TIME_TO_SEC('15:30') - TIME_TO_SEC(CURTIME()) <= 3600 then 'NEAR DELAYED' else NULL end end end as delaystatus from ops_exec where (name like 'DLY_ATTRIBUTION_JANUS_3.0_$%' or name like 'DLY_ATTRIBUTION_JANUS_3.0_201%' or name='DLY_ATTRIBUTION_JANUS_3.0') and cast(trigger_time as date)=current_date;
select 'attribution_3.1' as subject, 'DLY_ATTRIBUTION_JANUS_3.1' as jobname, case status_code when 200 then 'SUCCESS' when 190 then 'FINISHED' when 80 then 'RUNNING' when 140 then ' FAILED' when 81 then ' FAILED' else ' WAITING' end as jobstatus, DATE_FORMAT(case when status_code=200 then end_time end, '%H:%i') as endtime, '15:30' as sla, SUBSTRING_INDEX(SEC_TO_TIME(TIME_TO_SEC(coalesce(time(case when status_code=200 then end_time end),CURTIME()))-TIME_TO_SEC('15:30')),':',2) as timediff, case when TIME_TO_SEC('15:30') - TIME_TO_SEC(coalesce(time(case when status_code=200 then end_time end),CURTIME())) < 0 then 'DELAYED' else case when case when status_code=200 then end_time end is not null then 'ON-TIME' else case when TIME_TO_SEC('15:30') - TIME_TO_SEC(CURTIME()) <= 3600 then 'NEAR DELAYED' else NULL end end end as delaystatus from ops_exec where (name like 'DLY_ATTRIBUTION_JANUS_3.1_$%' or name like 'DLY_ATTRIBUTION_JANUS_3.1_201%' or name='DLY_ATTRIBUTION_JANUS_3.1') and cast(trigger_time as date)=current_date;
select 'bld_performance' as subject, 'DLY_BLOODHOUND' as jobname, case status_code when 200 then 'SUCCESS' when 190 then 'FINISHED' when 80 then 'RUNNING' when 140 then ' FAILED' when 81 then ' FAILED' else ' WAITING' end as jobstatus, DATE_FORMAT(case when status_code=200 then end_time end, '%H:%i') as endtime, '12:00' as sla, SUBSTRING_INDEX(SEC_TO_TIME(TIME_TO_SEC(coalesce(time(case when status_code=200 then end_time end),CURTIME()))-TIME_TO_SEC('12:00')),':',2) as timediff, case when TIME_TO_SEC('12:00') - TIME_TO_SEC(coalesce(time(case when status_code=200 then end_time end),CURTIME())) < 0 then 'DELAYED' else case when case when status_code=200 then end_time end is not null then 'ON-TIME' else case when TIME_TO_SEC('12:00') - TIME_TO_SEC(CURTIME()) <= 3600 then 'NEAR DELAYED' else NULL end end end as delaystatus from ops_exec where (name like 'DLY_BLOODHOUND_$%' or name like 'DLY_BLOODHOUND_201%' or name='DLY_BLOODHOUND') and cast(trigger_time as date)=current_date;
select 'email' as subject, 'DLY_EMAIL' as jobname, case status_code when 200 then 'SUCCESS' when 190 then 'FINISHED' when 80 then 'RUNNING' when 140 then ' FAILED' when 81 then ' FAILED' else ' WAITING' end as jobstatus, DATE_FORMAT(case when status_code=200 then end_time end, '%H:%i') as endtime, '15:30' as sla, SUBSTRING_INDEX(SEC_TO_TIME(TIME_TO_SEC(coalesce(time(case when status_code=200 then end_time end),CURTIME()))-TIME_TO_SEC('15:30')),':',2) as timediff, case when TIME_TO_SEC('15:30') - TIME_TO_SEC(coalesce(time(case when status_code=200 then end_time end),CURTIME())) < 0 then 'DELAYED' else case when case when status_code=200 then end_time end is not null then 'ON-TIME' else case when TIME_TO_SEC('15:30') - TIME_TO_SEC(CURTIME()) <= 3600 then 'NEAR DELAYED' else NULL end end end as delaystatus from ops_exec where (name like 'DLY_EMAIL_$%' or name like 'DLY_EMAIL_201%' or name='DLY_EMAIL') and cast(trigger_time as date)=current_date;
select 'fact_collections' as subject, 'LOAD_FACT_COLLECTIONS_MV' as jobname, case status_code when 200 then 'SUCCESS' when 190 then 'FINISHED' when 80 then 'RUNNING' when 140 then ' FAILED' when 81 then ' FAILED' else ' WAITING' end as jobstatus, DATE_FORMAT(case when status_code=200 then end_time end, '%H:%i') as endtime, '12:00' as sla, SUBSTRING_INDEX(SEC_TO_TIME(TIME_TO_SEC(coalesce(time(case when status_code=200 then end_time end),CURTIME()))-TIME_TO_SEC('12:00')),':',2) as timediff, case when TIME_TO_SEC('12:00') - TIME_TO_SEC(coalesce(time(case when status_code=200 then end_time end),CURTIME())) < 0 then 'DELAYED' else case when case when status_code=200 then end_time end is not null then 'ON-TIME' else case when TIME_TO_SEC('12:00') - TIME_TO_SEC(CURTIME()) <= 3600 then 'NEAR DELAYED' else NULL end end end as delaystatus from ops_exec where (name like 'LOAD_FACT_COLLECTIONS_MV_$%' or name like 'LOAD_FACT_COLLECTIONS_MV_201%' or name='LOAD_FACT_COLLECTIONS_MV') and cast(trigger_time as date)=current_date;
select 'fact_global_financial' as subject, 'DLY_INTERNATIONAL' as jobname, case status_code when 200 then 'SUCCESS' when 190 then 'FINISHED' when 80 then 'RUNNING' when 140 then ' FAILED' when 81 then ' FAILED' else ' WAITING' end as jobstatus, DATE_FORMAT(case when status_code=200 then end_time end, '%H:%i') as endtime, '15:30' as sla, SUBSTRING_INDEX(SEC_TO_TIME(TIME_TO_SEC(coalesce(time(case when status_code=200 then end_time end),CURTIME()))-TIME_TO_SEC('15:30')),':',2) as timediff, case when TIME_TO_SEC('15:30') - TIME_TO_SEC(coalesce(time(case when status_code=200 then end_time end),CURTIME())) < 0 then 'DELAYED' else case when case when status_code=200 then end_time end is not null then 'ON-TIME' else case when TIME_TO_SEC('15:30') - TIME_TO_SEC(CURTIME()) <= 3600 then 'NEAR DELAYED' else NULL end end end as delaystatus from ops_exec where (name like 'DLY_INTERNATIONAL_$%' or name like 'DLY_INTERNATIONAL_201%' or name='DLY_INTERNATIONAL') and cast(trigger_time as date)=current_date;
select 'fact_order_ship_delivers' as subject, 'DLY_STS_GOODS' as jobname, case status_code when 200 then 'SUCCESS' when 190 then 'FINISHED' when 80 then 'RUNNING' when 140 then ' FAILED' when 81 then ' FAILED' else ' WAITING' end as jobstatus, DATE_FORMAT(case when status_code=200 then end_time end, '%H:%i') as endtime, '15:30' as sla, SUBSTRING_INDEX(SEC_TO_TIME(TIME_TO_SEC(coalesce(time(case when status_code=200 then end_time end),CURTIME()))-TIME_TO_SEC('15:30')),':',2) as timediff, case when TIME_TO_SEC('15:30') - TIME_TO_SEC(coalesce(time(case when status_code=200 then end_time end),CURTIME())) < 0 then 'DELAYED' else case when case when status_code=200 then end_time end is not null then 'ON-TIME' else case when TIME_TO_SEC('15:30') - TIME_TO_SEC(CURTIME()) <= 3600 then 'NEAR DELAYED' else NULL end end end as delaystatus from ops_exec where (name like 'DLY_STS_GOODS_$%' or name like 'DLY_STS_GOODS_201%' or name='DLY_STS_GOODS') and cast(trigger_time as date)=current_date;
select 'gbl_fact_transactions_cd' as subject, 'LOAD_GBL_TABLE_CD' as jobname, case status_code when 200 then 'SUCCESS' when 190 then 'FINISHED' when 80 then 'RUNNING' when 140 then ' FAILED' when 81 then ' FAILED' else ' WAITING' end as jobstatus, DATE_FORMAT(case when status_code=200 then end_time end, '%H:%i') as endtime, '09:00' as sla, SUBSTRING_INDEX(SEC_TO_TIME(TIME_TO_SEC(coalesce(time(case when status_code=200 then end_time end),CURTIME()))-TIME_TO_SEC('09:00')),':',2) as timediff, case when TIME_TO_SEC('09:00') - TIME_TO_SEC(coalesce(time(case when status_code=200 then end_time end),CURTIME())) < 0 then 'DELAYED' else case when case when status_code=200 then end_time end is not null then 'ON-TIME' else case when TIME_TO_SEC('09:00') - TIME_TO_SEC(CURTIME()) <= 3600 then 'NEAR DELAYED' else NULL end end end as delaystatus from ops_exec where (name like 'LOAD_GBL_TABLE_CD_$%' or name like 'LOAD_GBL_TABLE_CD_201%' or name='LOAD_GBL_TABLE_CD') and cast(trigger_time as date)=current_date;
select 'gbl_fact_transactions_na' as subject, 'LOAD_GBL_FACT_TRANSACTIONS_NA' as jobname, case status_code when 200 then 'SUCCESS' when 190 then 'FINISHED' when 80 then 'RUNNING' when 140 then ' FAILED' when 81 then ' FAILED' else ' WAITING' end as jobstatus, DATE_FORMAT(case when status_code=200 then end_time end, '%H:%i') as endtime, '09:00' as sla, SUBSTRING_INDEX(SEC_TO_TIME(TIME_TO_SEC(coalesce(time(case when status_code=200 then end_time end),CURTIME()))-TIME_TO_SEC('09:00')),':',2) as timediff, case when TIME_TO_SEC('09:00') - TIME_TO_SEC(coalesce(time(case when status_code=200 then end_time end),CURTIME())) < 0 then 'DELAYED' else case when case when status_code=200 then end_time end is not null then 'ON-TIME' else case when TIME_TO_SEC('09:00') - TIME_TO_SEC(CURTIME()) <= 3600 then 'NEAR DELAYED' else NULL end end end as delaystatus from ops_exec where (name like 'LOAD_GBL_FACT_TRANSACTIONS_NA_$%' or name like 'LOAD_GBL_FACT_TRANSACTIONS_NA_201%' or name='LOAD_GBL_FACT_TRANSACTIONS_NA') and cast(trigger_time as date)=current_date;
select 'gbl_fact_transactions' as subject, 'DLY_GBL_CEREBRO_COPY' as jobname, case status_code when 200 then 'SUCCESS' when 190 then 'FINISHED' when 80 then 'RUNNING' when 140 then ' FAILED' when 81 then ' FAILED' else ' WAITING' end as jobstatus, DATE_FORMAT(case when status_code=200 then end_time end, '%H:%i') as endtime, '15:30' as sla, SUBSTRING_INDEX(SEC_TO_TIME(TIME_TO_SEC(coalesce(time(case when status_code=200 then end_time end),CURTIME()))-TIME_TO_SEC('15:30')),':',2) as timediff, case when TIME_TO_SEC('15:30') - TIME_TO_SEC(coalesce(time(case when status_code=200 then end_time end),CURTIME())) < 0 then 'DELAYED' else case when case when status_code=200 then end_time end is not null then 'ON-TIME' else case when TIME_TO_SEC('15:30') - TIME_TO_SEC(CURTIME()) <= 3600 then 'NEAR DELAYED' else NULL end end end as delaystatus from ops_exec where (name like 'DLY_GBL_CEREBRO_COPY_$%' or name like 'DLY_GBL_CEREBRO_COPY_201%' or name='DLY_GBL_CEREBRO_COPY') and cast(trigger_time as date)=current_date;
select 'gbl_performance' as subject, 'DLY_WBR_GBL_MARKETING_ANALYTICS' as jobname, case status_code when 200 then 'SUCCESS' when 190 then 'FINISHED' when 80 then 'RUNNING' when 140 then ' FAILED' when 81 then ' FAILED' else ' WAITING' end as jobstatus, DATE_FORMAT(case when status_code=200 then end_time end, '%H:%i') as endtime, '20:00' as sla, SUBSTRING_INDEX(SEC_TO_TIME(TIME_TO_SEC(coalesce(time(case when status_code=200 then end_time end),CURTIME()))-TIME_TO_SEC('20:00')),':',2) as timediff, case when TIME_TO_SEC('20:00') - TIME_TO_SEC(coalesce(time(case when status_code=200 then end_time end),CURTIME())) < 0 then 'DELAYED' else case when case when status_code=200 then end_time end is not null then 'ON-TIME' else case when TIME_TO_SEC('20:00') - TIME_TO_SEC(CURTIME()) <= 3600 then 'NEAR DELAYED' else NULL end end end as delaystatus from ops_exec where (name like 'DLY_WBR_GBL_MARKETING_ANALYTICS_$%' or name like 'DLY_WBR_GBL_MARKETING_ANALYTICS_201%' or name='DLY_WBR_GBL_MARKETING_ANALYTICS') and cast(trigger_time as date)=current_date;
select 'gbl_superfunnel_core*' as subject, 'DLY_JANUS_SUPER_FUNNEL' as jobname, case status_code when 200 then 'SUCCESS' when 190 then 'FINISHED' when 80 then 'RUNNING' when 140 then ' FAILED' when 81 then ' FAILED' else ' WAITING' end as jobstatus, DATE_FORMAT(case when status_code=200 then end_time end, '%H:%i') as endtime, '11:00' as sla, SUBSTRING_INDEX(SEC_TO_TIME(TIME_TO_SEC(coalesce(time(case when status_code=200 then end_time end),CURTIME()))-TIME_TO_SEC('11:00')),':',2) as timediff, case when TIME_TO_SEC('11:00') - TIME_TO_SEC(coalesce(time(case when status_code=200 then end_time end),CURTIME())) < 0 then 'DELAYED' else case when case when status_code=200 then end_time end is not null then 'ON-TIME' else case when TIME_TO_SEC('11:00') - TIME_TO_SEC(CURTIME()) <= 3600 then 'NEAR DELAYED' else NULL end end end as delaystatus from ops_exec where (name like 'DLY_JANUS_SUPER_FUNNEL_$%' or name like 'DLY_JANUS_SUPER_FUNNEL_201%' or name='DLY_JANUS_SUPER_FUNNEL') and cast(trigger_time as date)=current_date;
select 'gbl_superfunnel*' as subject, 'DLY_SUPERFUNNEL_V3' as jobname, case status_code when 200 then 'SUCCESS' when 190 then 'FINISHED' when 80 then 'RUNNING' when 140 then ' FAILED' when 81 then ' FAILED' else ' WAITING' end as jobstatus, DATE_FORMAT(case when status_code=200 then end_time end, '%H:%i') as endtime, '18:00' as sla, SUBSTRING_INDEX(SEC_TO_TIME(TIME_TO_SEC(coalesce(time(case when status_code=200 then end_time end),CURTIME()))-TIME_TO_SEC('18:00')),':',2) as timediff, case when TIME_TO_SEC('18:00') - TIME_TO_SEC(coalesce(time(case when status_code=200 then end_time end),CURTIME())) < 0 then 'DELAYED' else case when case when status_code=200 then end_time end is not null then 'ON-TIME' else case when TIME_TO_SEC('18:00') - TIME_TO_SEC(CURTIME()) <= 3600 then 'NEAR DELAYED' else NULL end end end as delaystatus from ops_exec where (name like 'DLY_SUPERFUNNEL_V3_$%' or name like 'DLY_SUPERFUNNEL_V3_201%' or name='DLY_SUPERFUNNEL_V3') and cast(trigger_time as date)=current_date;
select 'goods_agg' as subject, 'DLY_LOAD_GOODS_DAY_DEAL' as jobname, case status_code when 200 then 'SUCCESS' when 190 then 'FINISHED' when 80 then 'RUNNING' when 140 then ' FAILED' when 81 then ' FAILED' else ' WAITING' end as jobstatus, DATE_FORMAT(case when status_code=200 then end_time end, '%H:%i') as endtime, '15:30' as sla, SUBSTRING_INDEX(SEC_TO_TIME(TIME_TO_SEC(coalesce(time(case when status_code=200 then end_time end),CURTIME()))-TIME_TO_SEC('15:30')),':',2) as timediff, case when TIME_TO_SEC('15:30') - TIME_TO_SEC(coalesce(time(case when status_code=200 then end_time end),CURTIME())) < 0 then 'DELAYED' else case when case when status_code=200 then end_time end is not null then 'ON-TIME' else case when TIME_TO_SEC('15:30') - TIME_TO_SEC(CURTIME()) <= 3600 then 'NEAR DELAYED' else NULL end end end as delaystatus from ops_exec where (name like 'DLY_LOAD_GOODS_DAY_DEAL_$%' or name like 'DLY_LOAD_GOODS_DAY_DEAL_201%' or name='DLY_LOAD_GOODS_DAY_DEAL') and cast(trigger_time as date)=current_date;
select 'mobile' as subject, 'MOBILE_AGG_FIRST_PAGEVIEW' as jobname, case status_code when 200 then 'SUCCESS' when 190 then 'FINISHED' when 80 then 'RUNNING' when 140 then ' FAILED' when 81 then ' FAILED' else ' WAITING' end as jobstatus, DATE_FORMAT(case when status_code=200 then end_time end, '%H:%i') as endtime, '09:00' as sla, SUBSTRING_INDEX(SEC_TO_TIME(TIME_TO_SEC(coalesce(time(case when status_code=200 then end_time end),CURTIME()))-TIME_TO_SEC('09:00')),':',2) as timediff, case when TIME_TO_SEC('09:00') - TIME_TO_SEC(coalesce(time(case when status_code=200 then end_time end),CURTIME())) < 0 then 'DELAYED' else case when case when status_code=200 then end_time end is not null then 'ON-TIME' else case when TIME_TO_SEC('09:00') - TIME_TO_SEC(CURTIME()) <= 3600 then 'NEAR DELAYED' else NULL end end end as delaystatus from ops_exec where (name like 'MOBILE_AGG_FIRST_PAGEVIEW_$%' or name like 'MOBILE_AGG_FIRST_PAGEVIEW_201%' or name='MOBILE_AGG_FIRST_PAGEVIEW') and cast(trigger_time as date)=current_date;
select 'sf_upload' as subject, 'DLY_SF_UPLOAD' as jobname, case status_code when 200 then 'SUCCESS' when 190 then 'FINISHED' when 80 then 'RUNNING' when 140 then ' FAILED' when 81 then ' FAILED' else ' WAITING' end as jobstatus, DATE_FORMAT(case when status_code=200 then end_time end, '%H:%i') as endtime, '14:00' as sla, SUBSTRING_INDEX(SEC_TO_TIME(TIME_TO_SEC(coalesce(time(case when status_code=200 then end_time end),CURTIME()))-TIME_TO_SEC('14:00')),':',2) as timediff, case when TIME_TO_SEC('14:00') - TIME_TO_SEC(coalesce(time(case when status_code=200 then end_time end),CURTIME())) < 0 then 'DELAYED' else case when case when status_code=200 then end_time end is not null then 'ON-TIME' else case when TIME_TO_SEC('14:00') - TIME_TO_SEC(CURTIME()) <= 3600 then 'NEAR DELAYED' else NULL end end end as delaystatus from ops_exec where (name like 'DLY_SF_UPLOAD_$%' or name like 'DLY_SF_UPLOAD_201%' or name='DLY_SF_UPLOAD') and cast(trigger_time as date)=current_date;
select 'zendesk_international' as subject, 'DLY_ZENDESK_INTL_NEW' as jobname, case status_code when 200 then 'SUCCESS' when 190 then 'FINISHED' when 80 then 'RUNNING' when 140 then ' FAILED' when 81 then ' FAILED' else ' WAITING' end as jobstatus, DATE_FORMAT(case when status_code=200 then end_time end, '%H:%i') as endtime, '09:00' as sla, SUBSTRING_INDEX(SEC_TO_TIME(TIME_TO_SEC(coalesce(time(case when status_code=200 then end_time end),CURTIME()))-TIME_TO_SEC('09:00')),':',2) as timediff, case when TIME_TO_SEC('09:00') - TIME_TO_SEC(coalesce(time(case when status_code=200 then end_time end),CURTIME())) < 0 then 'DELAYED' else case when case when status_code=200 then end_time end is not null then 'ON-TIME' else case when TIME_TO_SEC('09:00') - TIME_TO_SEC(CURTIME()) <= 3600 then 'NEAR DELAYED' else NULL end end end as delaystatus from ops_exec where (name like 'DLY_ZENDESK_INTL_NEW_$%' or name like 'DLY_ZENDESK_INTL_NEW_201%' or name='DLY_ZENDESK_INTL_NEW') and cast(trigger_time as date)=current_date;
select 'zendesk_us' as subject, 'DLY_ZENDESK_US' as jobname, case status_code when 200 then 'SUCCESS' when 190 then 'FINISHED' when 80 then 'RUNNING' when 140 then ' FAILED' when 81 then ' FAILED' else ' WAITING' end as jobstatus, DATE_FORMAT(case when status_code=200 then end_time end, '%H:%i') as endtime, '13:00' as sla, SUBSTRING_INDEX(SEC_TO_TIME(TIME_TO_SEC(coalesce(time(case when status_code=200 then end_time end),CURTIME()))-TIME_TO_SEC('13:00')),':',2) as timediff, case when TIME_TO_SEC('13:00') - TIME_TO_SEC(coalesce(time(case when status_code=200 then end_time end),CURTIME())) < 0 then 'DELAYED' else case when case when status_code=200 then end_time end is not null then 'ON-TIME' else case when TIME_TO_SEC('13:00') - TIME_TO_SEC(CURTIME()) <= 3600 then 'NEAR DELAYED' else NULL end end end as delaystatus from ops_exec where (name like 'DLY_ZENDESK_US_$%' or name like 'DLY_ZENDESK_US_201%' or name='DLY_ZENDESK_US') and cast(trigger_time as date)=current_date;
select 'gbl_email_impression_agg' as subject, 'DLY_GBL_EMAIL_IMPRESSION_AGG' as jobname, case status_code when 200 then 'SUCCESS' when 190 then 'FINISHED' when 80 then 'RUNNING' when 140 then ' FAILED' when 81 then ' FAILED' else ' WAITING' end as jobstatus, DATE_FORMAT(case when status_code=200 then end_time end, '%H:%i') as endtime, '12:00' as sla, SUBSTRING_INDEX(SEC_TO_TIME(TIME_TO_SEC(coalesce(time(case when status_code=200 then end_time end),CURTIME()))-TIME_TO_SEC('12:00')),':',2) as timediff, case when TIME_TO_SEC('12:00') - TIME_TO_SEC(coalesce(time(case when status_code=200 then end_time end),CURTIME())) < 0 then 'DELAYED' else case when case when status_code=200 then end_time end is not null then 'ON-TIME' else case when TIME_TO_SEC('12:00') - TIME_TO_SEC(CURTIME()) <= 3600 then 'NEAR DELAYED' else NULL end end end as delaystatus from ops_exec where (name like 'DLY_GBL_EMAIL_IMPRESSION_AGG_$%' or name like 'DLY_GBL_EMAIL_IMPRESSION_AGG_201%' or name='DLY_GBL_EMAIL_IMPRESSION_AGG') and cast(trigger_time as date)=current_date;
select 'NA_push_notification' as subject, 'DLY_MOBILE_PUSH_NOTIFICATION' as jobname, case status_code when 200 then 'SUCCESS' when 190 then 'FINISHED' when 80 then 'RUNNING' when 140 then ' FAILED' when 81 then ' FAILED' else ' WAITING' end as jobstatus, DATE_FORMAT(case when status_code=200 then end_time end, '%H:%i') as endtime, '19:00' as sla, SUBSTRING_INDEX(SEC_TO_TIME(TIME_TO_SEC(coalesce(time(case when status_code=200 then end_time end),CURTIME()))-TIME_TO_SEC('19:00')),':',2) as timediff, case when TIME_TO_SEC('19:00') - TIME_TO_SEC(coalesce(time(case when status_code=200 then end_time end),CURTIME())) < 0 then 'DELAYED' else case when case when status_code=200 then end_time end is not null then 'ON-TIME' else case when TIME_TO_SEC('19:00') - TIME_TO_SEC(CURTIME()) <= 3600 then 'NEAR DELAYED' else NULL end end end as delaystatus from ops_exec where (name like 'DLY_MOBILE_PUSH_NOTIFICATION_$%' or name like 'DLY_MOBILE_PUSH_NOTIFICATION_201%' or name='DLY_MOBILE_PUSH_NOTIFICATION') and cast(trigger_time as date)=current_date;
select 'EMEA_push_notification' as subject, 'DLY_MOBILE_PUSH_NOTIFICATION_EMEA' as jobname, case status_code when 200 then 'SUCCESS' when 190 then 'FINISHED' when 80 then 'RUNNING' when 140 then ' FAILED' when 81 then ' FAILED' else ' WAITING' end as jobstatus, DATE_FORMAT(case when status_code=200 then end_time end, '%H:%i') as endtime, '19:00' as sla, SUBSTRING_INDEX(SEC_TO_TIME(TIME_TO_SEC(coalesce(time(case when status_code=200 then end_time end),CURTIME()))-TIME_TO_SEC('19:00')),':',2) as timediff, case when TIME_TO_SEC('19:00') - TIME_TO_SEC(coalesce(time(case when status_code=200 then end_time end),CURTIME())) < 0 then 'DELAYED' else case when case when status_code=200 then end_time end is not null then 'ON-TIME' else case when TIME_TO_SEC('19:00') - TIME_TO_SEC(CURTIME()) <= 3600 then 'NEAR DELAYED' else NULL end end end as delaystatus from ops_exec where (name like 'DLY_MOBILE_PUSH_NOTIFICATION_EMEA_$%' or name like 'DLY_MOBILE_PUSH_NOTIFICATION_EMEA_201%' or name='DLY_MOBILE_PUSH_NOTIFICATION_EMEA') and cast(trigger_time as date)=current_date;
